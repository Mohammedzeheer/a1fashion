
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@7.12.15/dist/sweetalert2.all.min.js"></script>
<link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/sweetalert2@7.12.15/dist/sweetalert2.min.css'></link>  

<link href="//netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.0/js/bootstrap.min.js"></script>
<script src="//code.jquery.com/jquery-1.11.1.min.js"></script>



    <!-- Breadcrumb Section Begin -->
    <section class="breadcrumb-option">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="breadcrumb__text">
                        <h4>Shopping Cart</h4>
                        <div class="breadcrumb__links">
                            <a href="/">Home</a>
                            <a href="/shop">Shop</a>
                            <span>Shopping Cart</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Breadcrumb Section End -->

    <!-- Shopping Cart Section Begin -->
    <section class="shopping-cart spad">
        <div class="container">
            <div class="row">
                <div class="col-lg-8">
                    <div class="shopping__cart__table">
                         {{#if cartList}}
                        <table>
                            <thead>
                                <tr>
                                    <th>Product</th>
                                    <th>Quantity</th>
                                    <th>Total</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                                {{else}}
                    <div class="container-fluid  mt-100">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="card">
                                        <div class="card-body cart">
                                            <div class="col-sm-12 empty-cart-cls text-center">
                                                <img src="https://i.imgur.com/dCdflKN.png" width="130" height="130" class="img-fluid mb-4 mr-3">
                                                <h3><strong>Your Cart is Empty</strong></h3>
                                           </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                          {{/if}}



                            {{#each cartList}}
                            
                                <tr>
                                    <td class="product__cart__item">
                                        <div class="product__cart__item__pic">
                                            <img style="width:5rem;height:5rem;" src="/productimage/{{productimage.[0]}}" alt="">
                                        </div>
                                        <div class="product__cart__item__text">
                                            <h6>{{productname}}</h6>
                                            <h5>{{productprice}}</h5>
                                        </div>
                                    </td>



                                      {{!-- <td class="quantity__item">
                                            <div class="value-button" id="decrease"
                                                onclick="decreaseValue(),updatequantity('{{_id}}',-1)"
                                                value="Decrease Value">-</div>
                                            <input type="number" id="number" value="{{quantity}}" />
                                           
                                            <div class="value-button" id="increase"
                                                onclick="increaseValue(),updatequantity('{{_id}}',1)"
                                                value="Increase Value">+</div>
                                        </td> --}}



{{!-- <td >
{{!-- <div class="input-group"> --}}
          <span class="input-group-btn">
              <button type="button" class="btn1 btn-danger btn-number"  data-type="minus" id="decrease" onclick="decreaseValue(),updatequantity('{{products.[0].productId}}',-1)" value="Decrease Value">
                <span class="glyphicon glyphicon-minus"></span>
              </button>
          </span>
          <input type="text" name="quant[2]" class="form-control1 input-number"  id="number" value="{{quantity}}" / />
          <span class="input-group-btn">
              <button type="button" class="btn1 btn-success btn-number" id="increase" onclick="increaseValue(),updatequantity('{{products.[0].productId}}',1)"value="Increase Value">
                  <span class="glyphicon glyphicon-plus"></span>
              </button>
          </span>
      {{!-- </div> --}}
</td> --}}


                <td>
                 <button class="btn-minus" onclick="updateQuantity('decrement', '{{_id}}','{{stock}}')"><i class="fa-solid fa-minus"></i></button>
                  <span class="quantity" data-id="{{_id}}">{{quantitypro}}</span>
                  <button class="btn-plus" onclick="updateQuantity('increment', '{{_id}}','{{stock}}')"><i class="fa-solid fa-plus"></i></button>
                </td>

                                   

                                    <td class="cart__price">{{totalprice}}</td>
                                     {{!-- <td  class="cart__close"><a  href="/deleteCart/{{_id}}"><i class="fa fa-close"></i></a></td> --}}
                                   
                           {{!-- <td><button onclick="deletecart('{{_id}}')"><i class="fa fa-trash"></i></button></td> --}}
                            <td><a href="/deleteCart?id={{_id}}" onclick="event.preventDefault(); deleteCart('{{_id}}');" class="fa fa-trash"></a></td>
                                       

                                   

                                </tr>

                       {{/each}}                               
                              
                            </tbody>
                        </table>
                    </div>


                    <div class="row">
                        <div class="col-lg-6 col-md-6 col-sm-6">
                            <div class="continue__btn">
                                <a href="/shop">Continue Shopping</a>
                            </div>
                        </div>
                        {{!-- <div class="col-lg-6 col-md-6 col-sm-6">
                            <div class="continue__btn update__btn">
                                <a href="#"><i class="fa fa-spinner"></i> Update cart</a>
                            </div>
                        </div> --}}
                    </div>
                </div>
                <div class="col-lg-4">
           {{#if cartList}}    
                    <div class="cart__discount">
                        <h6>Discount codes</h6>
                        <form action="/userTryCouponCode" method="post">
                            <input type="text" placeholder="Coupon code" name="couponcode" >
                            <button type="submit">Apply</button>
                        </form>       
                         <a style="color:red">{{couponError}}</a>             
                    </div>

                       
                    <div class="cart__total">
                        <h6>Cart total</h6>
                        <ul>
                            <li>Subtotal ₹<span>{{subtotal}}</span></li>
                            <li>Shipping Charge ₹<span>: 66</span></li>
                            <li>Coupon Discount ₹<span>{{discountvalue}}</span></li>
                            <li>Total ₹<span>{{grandtotal}}</span></li>
                        </ul>
                        <a href="/checkout" class="primary-btn">Proceed to checkout</a>
                    </div>
                 {{/if}}
                  
                    

                </div>
            </div>
        </div>
    </section>
    <!-- Shopping Cart Section End -->


<link rel="stylesheet" href="css/deletemodelpopup.css" type="text/css">



 {{!-- delete ajax work code  --}}

<script src="https://cdn.jsdelivr.net/npm/sweetalert@2"></script>

<script>
    function deleteCart(productId) {
  swal({
    title: "Do you want to delete?",
    text: "Are you sure you want to delete this product from your shopping cart?",
    icon: "warning",
    buttons: ["Cancel", "Ok"],
    dangerMode: true,
  })
  .then((shouldDelete) => {
    if (shouldDelete) {
      window.location.href = "/deleteCart?id=" + productId;
    }
  });
}

</script>



<script>
        function increaseValue() {
            var value = parseInt(document.getElementById('number').value, 10);
            value = isNaN(value) ? 0 : value;
            value++;
            document.getElementById('number').value = value;
        }

        function decreaseValue() {
            var value = parseInt(document.getElementById('number').value, 10);
            value = isNaN(value) ? 0 : value;
            value < 1 ? value = 1 : '';

            value--;
            if(value==0){
                value.remove()
            }
            document.getElementById('number').value = value;
        }
    </script>


      <script>
        function updatequantity(productId, count) {

            $.ajax({
                url: '/updateQuantity',
                data: {
                    products: productId,
                    count: count
                },
                method: 'post',
                success: (response) => {

                   // location.href="/shoppingCart"

                        if (response.status==true) {                         
                         location.replace('/shoppingCart')
                    }
                 
                }
            })
        }
    </script>


 {{!-- css for plus and minus button --}}
<style>
    .form-control1 {
    display: block;
    width: 38px;
    height: 34px;
    padding: 6px 12px;
    font-size: 14px;
    line-height: 1.428571429;
    color: #555;
    background-color: #fff;
    background-image: none;
    border: 1px solid #ccc;
    border-radius: 4px;
    -webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075);
    box-shadow: inset 0 1px 1px rgba(0,0,0,.075);
    -webkit-transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s;
    transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s;
}
.btn1 {
    display: inline-block;
    margin-bottom: 0;
    font-weight: 400;
    text-align: center;
    vertical-align: middle;
    cursor: pointer;
    background-image: none;
    border: 0px solid transparent;
    white-space: nowrap;
    padding: 6px 12px;
    font-size: 14px;
    line-height: 1.428571429;
    border-radius: 0px;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    -o-user-select: none;
    user-select: none;
}
</style>














